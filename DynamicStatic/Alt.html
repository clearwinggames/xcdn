<html>
<head>
<script src="./vue2.js"></script>
<script src="./vueRouter.js"></script>
</head>
<body>
<div id="app">
  <div>
    <router-view name="alt"></router-view>
  </div>
  <div>
    <a href='https://clearwinggames.github.io/xcdn/DynamicStatic/Alt#/Second'>Second</a>
  </div>
  <div>
      <router-view>
      </router-view>
  </div>
  <div>
    <router-view name="altalt"></router-view>
  </div>
</div>
<script>
  Vue.use(VueRouter);
  
const routes = [
    { path: '/', component: { template: '<div>Home Page</div>' } },
    { path: '/First', component: { template: '<div>Cool Page</div>' } },
  
  { 
    path: '/Second', 
    component: { template: '<div>Temp Test: <temp-test /></div>' },
    children: [
      {
        path: '/Second/More', 
        name: "altalt", 
        component: { template: '<div>TRL1: <temp-routerlink-1 /></div>' }
      }
    ]
  },
  
  { path: '/Third', component: { template: '<div>Final Page</div>' } },
  { path: '/Third/One', component: { template: '<div>Secret Final Page</div>' } },  
  { path: '/Third/Two', components: { alt: { template: '<div>Secret Final Page 2</div>' }, altalt: { template: '<div>Secretive Page X</div>' } } }
  
];

var router = new VueRouter({
  routes
});
  
var vue = new Vue
({
router,
el: '#app',
data: {
  router_hub: router,
  is_debug: false
}
});

Vue.component('temp-test', {
    props: [],
    data: function() {
      return {

      };
    },
    template: `
      <div>
        <div>
        Temp Test Here: <temp-routerlink-x />
        </div>
      <div>
        TRL0 Also: <temp-routerlink-0 />
      </div>
      </div>
    `
});
  Vue.component('temp-routerlink-x', {
    template: '<div>Temp RLX</div>'
  });
  for (let i = 0; i < 5; i++) 
  {
  Vue.component('temp-routerlink-' + i.toString(), {
    props: [],
    data: function() {
      return {
      };
    },
    template: `
      <div>
        RV${i.toString()}<br />
         <router-view name='level${(i+1).toString()}'></router-view>
      </div>
    `
});
    Vue.component('temp-link-' + i.toString(), {
      props: [],
      data: function() {
        return {
        };
      }, 
      template: `
          <div>
            RL${i.toString()}<br />
            <temp-routerlink-${(i+1).toString()}' />
          </div>
      `
    });
  }

  function httpGet(url) 
{
  return new Promise(function(resolve, reject) 
  {  
    let xhttp = new XMLHttpRequest();

    xhttp.onreadystatechange = function() 
    {
        if (this.readyState === 4 && this.status === 200) 
        {
          resolve(this.responseText);
        }
        else if (this.readyState === 4)
        {
            if (this.status === 204)
            {
              resolve('[No Content Found]');
            }
            else if (this.status === 401) 
            {
              resolve('[NOT AUTHORIZED. LOG IN AS ADMINISTRATOR FIRST]');
            }
            else if (this.status === 401) 
            {
              resolve('[FORBIDDEN. LOG IN AS ADMINISTRATOR FIRST]');
            }
            else if (this.status === 500) 
            {
              resolve('[Internal Server Error.]');
            }
            else 
            {
              resolve('Status calling HttpGet at ' + url + ': ' + this.status.toString());
            }
        }
    };

    xhttp.open('GET', url, true);
    xhttp.setRequestHeader('Content-Type', 'application/json');
    xhttp.send();
  });
}
  
  setTimeout(() => {
    httpGet('https://clearwinggames.github.io/ValleyOfMasks/lib/main.js').then(x => alert(X));
  }, 2000);
</script>
<script>
  const STORAGE_KEY = 'savedTextFileContent';
const FILENAME_KEY = 'savedTextFileName';

function uploadFile() {
    const fileInput = document.getElementById('fileInput');
    const messageArea = document.getElementById('message');
    const file = fileInput.files[0];

    if (!file) {
        messageArea.textContent = 'Please select a file first.';
        return;
    }

    // Check if the file is a text file
    if (file.type && !file.type.startsWith('text/')) {
        messageArea.textContent = 'Please select a text file (.txt).';
        return;
    }

    const reader = new FileReader();

    reader.onload = function(event) {
        const fileContent = event.target.result;
        try {
            // Store the content and file name in localStorage as strings
            localStorage.setItem(STORAGE_KEY, fileContent);
            localStorage.setItem(FILENAME_KEY, file.name);
            messageArea.textContent = `File "${file.name}" successfully saved to localStorage.`;
            console.log('File content saved:', fileContent);
        } catch (e) {
            messageArea.textContent = 'Failed to save file to localStorage. Storage might be full.';
            console.error('localStorage error:', e);
        }
    };

    reader.onerror = function() {
        messageArea.textContent = 'Error reading file.';
    };

    // Read the file content as plain text
    reader.readAsText(file);
}

function downloadFile() {
    const downloadMessageArea = document.getElementById('downloadMessage');
    const savedContent = localStorage.getItem(STORAGE_KEY);
    const savedFileName = localStorage.getItem(FILENAME_KEY) || 'downloaded_file.txt';

    if (!savedContent) {
        downloadMessageArea.textContent = 'No file content found in localStorage.';
        return;
    }

    // Create a Blob from the saved content
    const blob = new Blob([savedContent], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);

    // Create a temporary anchor element to trigger the download
    const a = document.createElement('a');
    a.href = url;
    a.download = savedFileName; // Set the file name for download
    a.style.display = 'none';
    document.body.appendChild(a);

    // Simulate a click to trigger the download, then clean up
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url); // Free up the object URL

    downloadMessageArea.textContent = `File "${savedFileName}" download initiated.`;
}
</script>
  <div>
      <h1>Upload Text File to LocalStorage</h1>
    <input type="file" id="fileInput" accept=".txt">
    <button onclick="uploadFile()">Upload and Save</button>
    <p id="message"></p>

    <h1>Download File from LocalStorage</h1>
    <button onclick="downloadFile()">Download Saved File</button>
    <p id="downloadMessage"></p>

  </div>
</body>
</html>
